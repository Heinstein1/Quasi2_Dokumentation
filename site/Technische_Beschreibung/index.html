<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Technical description of main components - Dokumentation Quasi II</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Technical description of main components";
        var mkdocs_page_input_path = "Technische_Beschreibung.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Dokumentation Quasi II
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Quasi II Dokumentation</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Technical description of main components</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#heat-pump-hp">Heat pump (HP)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#general-description-of-hp">General description of HP</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#modelling-approaches-for-hp-overview">Modelling approaches for HP: Overview</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#modelling-approaches-for-hp-detail">Modelling approaches for HP: Detail</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#steps-to-perform-in-the-simulation-model-of-the-heat-pump">Steps to perform in the simulation model of the heat pump</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#electrolyser">Electrolyser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reduction-of-usable-heat-during-start-up">Reduction of usable heat during start-up</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#combined-heat-and-power-plant-chp">Combined heat and power plant (CHP)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#gas-boiler-gb">Gas boiler (GB)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#oil-heating-oh">Oil heating (OH)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#elecric-heating-rod-er">Elecric heating rod (ER)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#biomass-boiler-bb">Biomass boiler (BB)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#heat-sources">Heat sources</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#soil">Soil</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#water">Water</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#air">Air</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#external-source">External source</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#chiller-ch">Chiller (CH)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#simple-model-for-electrolyser">Simple model for electrolyser</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#general-model-for-cooling-purposes">General model for cooling purposes</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#short-term-thermal-energy-storage-sttes">Short-term thermal energy storage (STTES)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#seasonal-thermal-energy-storage-stes">Seasonal thermal energy storage (STES)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#tank-ttes-and-pit-ptes-thermal-energy-storage">Tank (TTES) and Pit (PTES) thermal energy storage</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#generalized-geometry-for-ttes-and-ptes">Generalized geometry for TTES and PTES</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#thermal-model-for-stratisfied-storage">Thermal model for stratisfied storage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#borehole-thermal-energy-storage-btes">Borehole thermal energy storage (BTES)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#aquifer-thermal-energy-storage-ates">Aquifer thermal energy storage (ATES)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ice-storage-is">Ice storage (IS)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#hydrogen-fuel-cell-fc">Hydrogen fuel cell (FC)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#photovoltaik-pv">Photovoltaik (PV)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#wind-power-wp">Wind power (WP)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#battery-ba">Battery (BA)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#hydrogen-compressor-hc">Hydrogen compressor (HC)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#todo">ToDo</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#references">References</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Test/">Test</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Dokumentation Quasi II</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Technical description of main components</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="technical-description-of-main-components">Technical description of main components</h1>
<h2 id="heat-pump-hp">Heat pump (HP)</h2>
<h3 id="general-description-of-hp">General description of HP</h3>
<p>As heat pumps, electrically driven variable-speed and on-off compressor heat pumps can be integrated into the simulation model of Quasi. Their general system chart with the denotation of the in- and outputs is shown in the figure below.</p>
<p><img alt="General System chart of a heat pump" src="../fig/221018_WP_Anlagenschema.svg" /></p>
<p>The energy balance at the heat pump is built up from the incoming electricity <script type="math/tex">P_{el,HP}</script>, the incoming heat at a low temperature level <script type="math/tex">T_{HP,source,in}</script> and the outgoing heat flow at a higher temperature level <script type="math/tex">T_{HP,sink,out}</script>. </p>
<p>The energy balance of the heat pump model is shown in the following figure:</p>
<p><img alt="Energy flow of heat pump" src="../fig/221006_W%C3%A4rmepumpe_Energiefluss.svg" /></p>
<p>The efficiency of the heat pump is defined by the coefficient of performance (COP). The COP determines the electrical power <script type="math/tex">P_{el,HP}</script> required to raise the temperature of a mass flow from the lower temperature level <script type="math/tex">T_{HP,source,in}</script> to <script type="math/tex">T_{HP,sink,out}</script>: </p>
<p>
<script type="math/tex; mode=display"> COP_{HP} = \frac{\dot{Q}_{HP,out}}{P_{el,HP}} \quad  \leq \quad COP_{Carnot} = \frac{T_{HP,sink,out}[K]}{T_{HP,sink,out}-T_{HP,source,in} } </script>
</p>
<p>
<script type="math/tex; mode=display"> COP_{HP} = \eta_{Carnot} \  COP_{Carnot} \quad \text{with} \quad 0 \leq \eta_{Carnot} \leq 1 </script>
</p>
<p>The COP is always smaller than the maximum possible Carnot coefficient of performance (<script type="math/tex">COP_{Carnot}</script>), which is calculated from the condenser outlet and evaporator inlet temperature. The maximum possible COP calculated by Carnot is reduced by the carnot effiency factor <script type="math/tex">\eta_{Carnot}</script>, which is according to [Arpagaus2018]<sup id="fnref:Arpagaus2018"><a class="footnote-ref" href="#fn:Arpagaus2018">2</a></sup> around 45 % for high temperature heat pumps and around 40 % for conventional heat pumps.</p>
<p>The energy balance (or power balance) of the heat pump can be drawn up on the basis of the latter figure and on the ratio between supplied and dissipated heat power, expressed as the COP:</p>
<p>
<script type="math/tex; mode=display">\dot{Q}_{HP,out} = \frac{COP_{HP}}{COP_{HP} -1} \ \dot{Q}_{HP,in} \mathrm{\quad with \quad} \dot{Q}_{HP,out} = \dot{Q}_{HP,in} + P_{HP,el} </script>
</p>
<p>The power of the heat pump's electric supply, including the losses of the power electronics, is given as: </p>
<p>
<script type="math/tex; mode=display">P_{el,HP,Bezug} = \frac{P_{el,HP}}{\eta_{HP,LE}}</script>
</p>
<p>Since the temperatures of the heat flows entering and leaving the heat pump, which have not been considered so far, may also be relevant for connected energy systems, the heat outputs can be calculated on the basis of the respective mass flow <script type="math/tex">\dot{m}</script> and the physical properties of the heat transfer medium (specific heat capacity <script type="math/tex">c_{p}</script> and, if applicable, the density <script type="math/tex">\rho</script>) by rearranging the following equation:</p>
<p>
<script type="math/tex; mode=display"> \dot{Q} = \dot{m} \ c_{p} \ (T_{max} - T_{min}) </script>
</p>
<h3 id="modelling-approaches-for-hp-overview">Modelling approaches for HP: Overview</h3>
<p>According to [Blervaque2015]<sup id="fnref:Blervaque2015"><a class="footnote-ref" href="#fn:Blervaque2015">1</a></sup>, four different categories are described in the literature when it comes to the simulation of heat pumps:</p>
<ul>
<li><strong>quasi-static empirical models</strong>: equation-fit models based on discretised manufacturer or certification data fitted to polynomes, used for example in EnergyPlus or TRNSYS</li>
<li><strong>dynamic empirical models</strong>: equasion-fit models extended by continious transient effects </li>
<li><strong>detailed physical models</strong>: thermodynamic approach based on dynamic and refrigerant flow modelling, many parameters required</li>
<li><strong>simplified physical models</strong> or parameter-estimation models: based on physical model, but with less input parameter needed due to internal assumptions</li>
</ul>
<p>For the simulation of energy systems in an early design phase, for which Quasi is intended, only quasi-static or dynamic empirical models can be considered due to the lack of detailed information about the technical components used and the computational effort required for physical models. Therefore, an empirical model based on manufacturer data or certification process data is implemented in Quasi.</p>
<p>There are several aspects to be considered when simulating a heat pump based on equation-fitting, which will be briefly described in the following:</p>
<p>The COP of a heat pump, representing the efficiency in a current time step, depends highly on the temperature of the source and the requested temperature of the heat demand. Generally speaking, the efficiency and thus the COP decreases with larger temperature differences between source and sink. </p>
<p>Additionaly, the maximum thermal power of the heat pump is not constant for different operation temperatures. The available thermal power is decreasing with lower source temperature, an effect that mainly occurs in heat pumps with air as the source medium. The rated power given for a specific heat pump is only valid for a specified combination of sink and source temperature. The specification for the declaration of the rated power is described in DIN EN 14511<sup id="fnref:DINEN14511"><a class="footnote-ref" href="#fn:DINEN14511">3</a></sup>.</p>
<p>Furthermore, the efficiency and therefor the COP is changing in part load operation. In the past, mostly on-off heat pump where used, regulating the total power output in a given time span by alternating the current state beween on and off. This causes efficency losses mostly due to thermal capacity effects and initial compression power needed at each start. (ToDo: Socal2021) 
In the last years, modulating heat pumps are more common, using a frequency inverter to adjust the speed of the compression motor and therefor affecting the power output. Interestingly, this method leads to an efficiency increase in part load operation with a peak in efficiency at around 30 to 60 % of the nominal power output. In the literature, many research groups have investigated this effect, compare for excample to Bettanini2003<sup id="fnref:Bettanini2003"><a class="footnote-ref" href="#fn:Bettanini2003">4</a></sup>, Toffanin2019<sup id="fnref:Toffanin2019"><a class="footnote-ref" href="#fn:Toffanin2019">5</a></sup>, Torregrosa-Jaime2008<sup id="fnref:Torregrosa-Jaime2008"><a class="footnote-ref" href="#fn:Torregrosa-Jaime2008">6</a></sup>, Fuentes2019<sup id="fnref:Fuentes2019"><a class="footnote-ref" href="#fn:Fuentes2019">7</a></sup>, Blervaque2015<sup id="fnref2:Blervaque2015"><a class="footnote-ref" href="#fn:Blervaque2015">1</a></sup> or Fahlen2012<sup id="fnref:Fahlen2012"><a class="footnote-ref" href="#fn:Fahlen2012">8</a></sup>.</p>
<p>For a most realistic representation, all three discussed effects need to be considered - temperature-dependent COP, temperature-dependent power and part-load-dependent COP. The calulation of these dependencies will be described below.</p>
<h3 id="modelling-approaches-for-hp-detail">Modelling approaches for HP: Detail</h3>
<p><strong>Temperature-dependent COP</strong></p>
<p>The temperature-dependend COP can be calculated from different methods:</p>
<ul>
<li>using the <script type="math/tex">COP_{Carnot}</script> with the carnot effiency factor <script type="math/tex">\eta_{Carnot}</script> as explained above (easy, simple and fast, but unreal high efficiency with small temperature differences of source and sink)</li>
<li>looking up the COP in a look-up table in dependence of the condenser outlet and the evaporator inlet temperature (for computational efficienc, lookup-tables are fitted to polynomes in pre-processing)</li>
<li>COP calculated as fraction of temperature-dependend electrical and thermal power, gained from generally developed polynomes. Here, the temperature-depended variation of the maximal power output of the heat pump can be directly taken into account.</li>
</ul>
<p>As example for a lookup-table COP (second bulletpoint above), the following figure from Steinacker2022<sup id="fnref:Steinacker2022"><a class="footnote-ref" href="#fn:Steinacker2022">15</a></sup> shows a map of a high-temperature heat pump as a set of curves, depending on the evaporator inlet and condenser outlet temperature. In three dimensions, this figure would result in a surface that can be parameterized with a three-dimensional spline interpolation algorithm.</p>
<p><img alt="COP chart of heat pump" src="../fig/COP_Kennfeld_Beispiel.png" />
ToDO: translate to english</p>
<p><strong>Maximum thermal and electrical power</strong></p>
<p>In order to adress a change in maximum power output or input of the heat pump at different operating temperatures, two different approaches can be used.</p>
<p>The more complex but also more accurate approache is the use of polynomial fits of temperature-dependend thermal and electrical power. These polynomes depend on the condenser outlet and the evaporator inlet temperature and they need to be calculated from manufacturer data or from measurements. </p>
<p>In order to adress the early planning stage, general, market-averaged polynomes need to be created, representing an average heat pump. Aditionally, one specific heat pump model can be used if the the required data is available. </p>
<p><strong>ToDo</strong>: Add method of calculating market-averaged polynomes!</p>
<p>Biquadratic polynomes according to TRNSYS Type 401
<script type="math/tex; mode=display"> \dot{Q}_{HP,max} = c_{q1} + c_{q2} \ \bar{T}_{HP,source,in} + c_{q3} \ \bar{T}_{HP,sink,out}  + c_{q4} \ \bar{T}_{HP,source,in} \ \bar{T}_{HP,sink,out} + \cdot  \cdot  \cdot \\
  \ c_{q5} \ \bar{T}_{HP,source,in}^2  + c_{q6} \ \bar{T}_{HP,sink,out}^2  </script>
</p>
<p>
<script type="math/tex; mode=display"> \dot{P}_{el,HP,max} = c_{p1} + c_{p2} \ \bar{T}_{HP,source,in} + c_{p3} \ \bar{T}_{HP,sink,out}  + c_{p4} \ \bar{T}_{HP,source,in} \ \bar{T}_{HP,sink,out} + \cdot  \cdot  \cdot \\
  \ c_{p5} \ \bar{T}_{HP,source,in}^2  + c_{p6} \ \bar{T}_{HP,sink,out}^2  </script>
where all temeratures have to be normed according to
<script type="math/tex; mode=display"> \bar{T} = \frac{T \ [°C]}{273.15} + 1 </script>
</p>
<p>The second method to adjust the electrical and thermal energy would be a linear gradient that adjust the rated power in dependency of one temperature. Checking the available data of many different heat pumps from Stiebel-Eltron<sup id="fnref:Stiebel-EltronTool"><a class="footnote-ref" href="#fn:Stiebel-EltronTool">9</a></sup>, a simplified correlation can be observed:</p>
<ul>
<li>the thermal power is dependend on the source temperature, but independent on the sink temperature (the lower the source temperature the lower is the heating power)</li>
<li>the electrical power is dependend on the sink temperature, but independent on the source temperature (the higher the sink temperature the higher is the electrical power consumption)</li>
</ul>
<p>This gives the possibility to linearly adjust the available thermal power with the change of the source temperature and the electrical power demand with the change of the temperature of the sink. Which power needs to be adjusted depends on the choice of the control strategy - thermally or electrically controlled.
The gradient of the power de- or increase with changing temperature needs to be specified.</p>
<p><strong>Part load efficiency</strong></p>
<p>The COP of the modeled heat pump depends not only on the temperatures of the sink and the source but also on the current part load ratio (PLR). The relation of the COP and the PLR is assumed to be non-linear. The COP can be corrected using a non-linear part load factor (PLF) in dependence of the PLR. </p>
<p>Part load ratio (PLR) = power (el. or th.) demand or availability in current time step in relation to maximum power (el. or th.) with current temperatures: <script type="math/tex">PLR = \frac{current \ power}{max. \ power} </script>
</p>
<p>Part load facor (PLF) = adjustment factor for COP at different PLR:  <script type="math/tex">COP_{part-load} = COP_{full-load} * PLF </script>
</p>
<p>It follows from the definition of the COP that the correlation between the electrical power consumption and the heat output of the heat pump in part load operation is therefore not linear too. For simplification, the heat output of the heat pump itself is assumed to linear in part load operation between <script type="math/tex">\dot{Q}_{HP,min}</script> at <script type="math/tex">PL_{HP,min}</script> and <script type="math/tex">\dot{Q}_{HP,max}</script> at 100% compressor speed as shown in the figure below. </p>
<p><img alt="Thermal power of heatpump in partload" src="../fig/221018_WP_Teillast_Heizleistung.svg" /></p>
<p>The coefficient of performance in partial load operation is approximated using a correction function. The literature provides different examples for the quadratic part-load behaviour of the COP (see section "Overview" for literature examples). As an example, the part-load-dependend COP of an ENRGI-Heatpump is shown in the following figure (Source: Enrgi<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">10</a></sup>)</p>
<p><img alt="COP in part load" src="../fig/COP_Teillast.png" /></p>
<p>The part-load behaviour depends also on the type of the heat pump (on-off or inverter heat pump), as shown for example in Bettanini2003<sup id="fnref2:Bettanini2003"><a class="footnote-ref" href="#fn:Bettanini2003">4</a></sup> or in Socal2021<sup id="fnref:Socal2021"><a class="footnote-ref" href="#fn:Socal2021">11</a></sup>. For illustration, the following figure is taken from the latter reference to demonstrate the different part load factors of the COP (y-axis) at different part load ratios for different heat pump technologies:</p>
<p><img alt="Image title" src="../fig/Socal2021_PLFfromPLR_angepasst.jpg" /></p>
<p>Taking the correction factor curve from the figure above for inverter heat pumps, the maximum part load factor is reached at 50 % part load with an increase of the COP of 1.1. Contrary, in Toffanin2019<sup id="fnref2:Toffanin2019"><a class="footnote-ref" href="#fn:Toffanin2019">5</a></sup>, the part load factor is assumed to be much higher, reaching its maximum at 25 % part load ratio with a part load factor of 2.1. These discrepancies illustrate the wide range of literature data and the difficulty in finding a general part load curve. </p>
<p>The figure above shows also the difference of the part load factor comparing on-off and inverter heat pumps as well as the defined on-off losses in DIN EN 14825 for the calculation of the seasonal coefficient of performance (SCOP).</p>
<p>ToDo: Description of method of PLF-Factor curcve in Quasi II: Using Blervaque2015? </p>
<h3 id="steps-to-perform-in-the-simulation-model-of-the-heat-pump">Steps to perform in the simulation model of the heat pump</h3>
<p>The calculation is based on TRNSYS Type 401<sup id="fnref:Wetter1996"><a class="footnote-ref" href="#fn:Wetter1996">12</a></sup> that is similar to Type 204<sup id="fnref:Alfjei1996"><a class="footnote-ref" href="#fn:Alfjei1996">13</a></sup>. The cycling losses of the heat pump in both TRNSYS models are calculated using an exponential function to describe the thermal capacity effecs during heat-up and cool-down. Here, these cycling losses will only be used during start and stop of the heat pump - actual cycling losses from on-off heatpumps will be considered separately in the process to allow the consideration of modulating heat pumps as well.</p>
<p>Steps to calculate the electrical and thermal energy in- and outputs of HP:</p>
<ul>
<li>using polynomial fits to calculate stationary thermal and electrical full-load power at given temperatures of <script type="math/tex">T_{HP,sink,out}</script> and <script type="math/tex">T_{HP,source,in}</script> for given nominal thermal power<ul>
<li>differing source and sink medium: <ul>
<li>air-water</li>
<li>water-water</li>
<li>sole-water</li>
</ul>
</li>
<li>differing temperature range: <ul>
<li>normale heat pump</li>
<li>high-temperature heat pump</li>
</ul>
</li>
<li>polynomial fits have to be normalized to rated power at specified temperatures! Rated power has to be related always to the same temperature lift according to DIN EN 14511 --&gt; different fits for normal (B10/W35, W10/W35, A10/W35) and high temperture (B35/W85, W35/W85) heat pumps  </li>
</ul>
</li>
<li>reduce thermal power output due to transient capacity effects during start-up as average over current time step</li>
<li>calculate COP at full load with calculated thermal and electrical power</li>
<li>get demand of thermal or electrical energy<ul>
<li>differing if thermal or electric energy related operation strategy is chosen</li>
</ul>
</li>
<li>calculate part load ratio (PLR) with current demand and temperature-dependend full-load power</li>
<li>get part load factor (PLF) from coeffcicient curve using the PLR to adjust full-load COP<ul>
<li>differing: modulating (intverter) or on-off heat pump</li>
</ul>
</li>
<li>calculate part-load COP using full-load COP and PLF</li>
<li>may adjust part-load COP by icing losses (air-water, air-air)</li>
<li>calculate the unknown power (either electrical or thermal) with adjusted part-load COP and known power</li>
</ul>
<p>Contraty to the TRNSYS Type 401, the mass flow here is variable and not constant within two timesteps, therefore the <script type="math/tex">T_{HP,sink,out}</script> and <script type="math/tex">\dot{Q}_{HP,sink,out}</script> can be calculated directly without the need of iteration as implemented in Type 401. Here, the <script type="math/tex">T_{HP,sink,out}</script> is a fixed, user-specified value in the presented simplified model. </p>
<p>The polynomes describing the temperature-depended thermal and electrical power of the heat pump need to be normalized to the power consumption at the rated operation point. Therefore, the following steps are necessary:</p>
<ul>
<li>fit data to polynome for thermal and electrical energy</li>
<li>calculate power at specified nominal temperatures with generated fitted polynome</li>
<li>normalize polynome to calculated rated power at specific temperature using a fraction_factor</li>
</ul>
<p>If universal data table or the Carnot-COP reduced by an efficiency factor should be used instead of the more accurate model described above, a different calculation approach is needed:</p>
<ul>
<li>Get power at current temperatures<ul>
<li>using nominal power without a temperature-dependency or</li>
<li>using polynomial fits to calculate stationary thermal <strong>or</strong> electrical full-load power at given temperatures of <script type="math/tex">T_{HP,sink,out}</script> and <script type="math/tex">T_{HP,source,in}</script>, depending on control strategy (see above)</li>
</ul>
</li>
<li>get stationary full-load COP at given temperatures of <script type="math/tex">T_{HP,sink,out}</script> and <script type="math/tex">T_{HP,source,in}</script> either from<ul>
<li>COP data table (fitted to polynome in pre-calculation) or</li>
<li>Carnot-COP reduced by an efficiency factor</li>
</ul>
</li>
<li>determine the unknown, non-controlled full load power (electrial or thermal) with known, controlled power and COP</li>
<li>get demand of controlled energy (thermal or electrical)<ul>
<li>differing if thermal or electric energy related operation strategy is chosen</li>
</ul>
</li>
<li>calculate part load ratio (PLR) with current demand and temperature-dependend full-load power</li>
<li>get part load factor (PLF) from coeffcicient curve using the PLR to adjust full-load COP<ul>
<li>differing: modulating (intverter) or on-off heat pump</li>
</ul>
</li>
<li>calculate part-load COP using full-load COP and PLF</li>
<li>may adjust part-load COP by icing losses (air-water, air-air)</li>
<li>calculate the non-controlled (either electrical or thermal) power with adjusted part-load COP and the controlled power</li>
</ul>
<p><strong>Inputs und Outputs of the Heat Pump:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\dot{Q}_{HP,in}</script>
</td>
<td>heat flow supplied to the HP (heat source)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{HP,out}</script>
</td>
<td>heat flow leaving the HP (heat sink)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,HP}</script>
</td>
<td>electric power demand of the HP</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,HP,supply}</script>
</td>
<td>electric power demand of the HP incl. losses of the power electronics</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{HP,sink,in}</script>
</td>
<td>condenser inlet temperature</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{HP,sink,out}</script>
</td>
<td>condenser outlet temperature</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{HP,source,in}</script>
</td>
<td>evaporator inlet temperature</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{HP,source,out}</script>
</td>
<td>evaporator outlet temperature</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the Heat Pump:</strong> ToDO</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\dot{Q}_{HP,max}</script>
</td>
<td>maximum thermal power of the heat pump</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{HP,min}</script>
</td>
<td>minimum thermal power of the heat pump at <script type="math/tex">PL_{HP,min}</script>
</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">PL_{HP,min}</script>
</td>
<td>minimum possible part load of the heat pump [%]</td>
<td></td>
</tr>
<tr>
<td>
<script type="math/tex">COP_{HP}(T_{HP,sink,out}, T_{HP,source,in}, x_{HP})</script>
</td>
<td>coefficient of performance (COP) of the heat pump incl. thermal losses depending on <script type="math/tex">T_{HP,sink,out}</script> and <script type="math/tex">T_{HP,source,in}</script> and on current state <script type="math/tex">x_{HP}</script>
</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{HP,PE}</script>
</td>
<td>efficiency of power electronics of heat pump</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{Carnot}</script>
</td>
<td>efficiency factor of heat pump, reduces the Carnot-COP</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">MOT_{HP}</script>
</td>
<td>minimum operating time of heat pump</td>
<td>[min]</td>
</tr>
<tr>
<td>
<script type="math/tex">SUP_{HP}</script>
</td>
<td>start-up time of the HP until full heat supply (linear curve)</td>
<td>[min]</td>
</tr>
</tbody>
</table>
<p><strong>State Variables of Heat Pump:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">x_{HP}</script>
</td>
<td>current operating state (on, off, part load)</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="electrolyser">Electrolyser</h2>
<p>The electrolyzer uses electrical energy to split water into its components hydrogen (<script type="math/tex">H_2</script>) and oxygen (<script type="math/tex">O_2</script>) as shown in the following reaction equation: </p>
<p>
<script type="math/tex; mode=display"> 2 \ H_2O \rightarrow 2 \ H_2 + O_2 </script>
</p>
<p>If the electrical energy is provided by renewable energies, the resulting hydrogen is labeled as "green hydrogen" and can be used to decarbonize the mobility or industrial sector or fed into the natural gas grid. The waste heat generated in the process can be used directly by feeding it into a heat network or via an intermediate heat pump. For flexible operation, it is possible to discharge the waste heat to the environment using a chiller. The use of waste heat is an important factor for the overall efficiency of the electrolyzer. </p>
<p>The general energy and mass flow in the electrolyser as well as the losses considered in the model can be seen in the following figure.</p>
<p>Fig. 5: Energy and mass flows in the electrolyser</p>
<p><img alt="Energy flow of electrolyser" src="../fig/221013_Elektrolyseur.svg" /></p>
<p>The relationship between supplied hydrogen of the electrolysis (energy (<script type="math/tex">\dot{E}_{Ely,H_2}</script>) or mass flow (<script type="math/tex">\dot{m}_{Ely,H_2}</script>)) and the consumption of electrical energy (<script type="math/tex"> P_{el,Ely} </script>) is given in the following equation, where <script type="math/tex">e_{H_2}</script> can be either the net or the gross calorific value of the hydrogen:
<script type="math/tex; mode=display">
\begin{align}
\dot{E}_{Ely,H_2}=  P_{el,Ely} \enspace \eta_{Ely,H_2}
\end{align}
</script>
</p>
<p>
<script type="math/tex; mode=display"> 
\begin{equation}
\dot{m}_{Ely,H_2} =  \frac{\dot{E}_{Ely,H_2}}{e_{H_2}} 
\end{equation}
</script>
</p>
<p>Due to the purification losses of the hydrogen caused by the reduction of oxygen molecules contained in the hydrogen gas in the catalyst, depending on the electrolysis technology, the actually obtained hydrogen energy or mass flow is reduced by the proportion of the hydrogen losses <script type="math/tex">\eta_{H_2 \ purification}</script> to the energy or mass flows, supplemented with index <script type="math/tex">out</script>:
<script type="math/tex; mode=display"> \dot{E}_{Ely,H_2,out}=  (1-\eta_{H_2 \ purification}) \ \dot{E}_{Ely,H_2} </script>
</p>
<p>
<script type="math/tex; mode=display"> \dot{m}_{Ely,H_2,out} = (1-\eta_{H_2 \ purification}) \ \dot{m}_{Ely,H_2} </script>
</p>
<p>Conversely, by rearranging and substituting the previous equations from a required hydrogen mass flow, the electrical power consumption can be calculated as follows:
<script type="math/tex; mode=display"> P_{el,Ely} =  \frac{\dot{m}_{Ely,H_2,out} \ e_{H_2}}{\eta_{Ely,H_2} \ (1 - \eta_{H_2 \ purification})}  </script>
</p>
<p>The usable waste heat from the electrolysis process <script type="math/tex">\dot{Q}_{Ely,waste heat}</script> is determined, depending on the available information, as
<script type="math/tex; mode=display">\dot{Q}_{Ely,waste heat} = \eta_{Ely,heat} \enspace (1-\eta_{Ely,H_2}) \enspace P_{el,Ely} = \frac{(1 - \eta_{Ely,H_2}) \ \eta_{Ely,heat} } { (1 - \eta_{H_2 \ purification}) \ \eta_{Ely,H_2} } \ \dot{E}_{Ely,H_2,out} </script>
</p>
<p>With a known mass flow <script type="math/tex">\dot{m}_{HP,cool}</script> and the specific heat capacity of the heat transfer medium of the heat recovery <script type="math/tex">c_{p,cool}</script> as well as a known inlet temperature <script type="math/tex">T_{Ely,cool,in}</script>, the outlet temperature of the heat transfer medium from the cooling circuit <script type="math/tex">T_{Ely,cool,out}</script> can be determined by rearranging the following equation:
<script type="math/tex; mode=display">\dot{Q}_{Ely,waste heat} = \dot{m}_{HP,cool} \enspace c_{p,cool} \enspace (T_{Ely,hot,out} - T_{Ely,cool,in})</script>
</p>
<p>The heat loss <script type="math/tex">\dot{Q}_{Ely,loss}</script>, which cannot be used and is dissipated to the environment via heat transport mechanisms, is calculated as follows</p>
<p>
<script type="math/tex; mode=display">  \dot{Q}_{Ely,loss} = P_{el,Ely} - \dot{Q}_{Ely,waste heat} - \dot{E}_{Ely,H_2} \\ =  P_{el,Ely} \ (1 - \eta_{Ely,heat} + \eta_{Ely,heat} \ \eta_{Ely,H_2} - \eta_{Ely,H_2}) </script>
</p>
<p>The actual needed power supply of the electrolyzer <script type="math/tex">P_{el,Ely,supply}</script> increases by losses in the power electronics and results from the electrical reference power <script type="math/tex">P_{el,Ely}</script> and the losses in the power electronics <script type="math/tex">\eta_{Ely,PE}</script> to
<script type="math/tex; mode=display"> P_{el,Ely,supply} = \frac{P_{el,Ely}}{\eta_{Ely,PE}} </script>
</p>
<p>Since the oxygen produced during the electrolysis process can also be utilized economically under certain circumstances, the resulting oxygen mass flow <script type="math/tex">\dot{m}_{Ely,O_2,out}</script> is determined from the stoichiometric ratio of the reaction equation of the water splitting described at the beginning:</p>
<p>
<script type="math/tex; mode=display">  \dot{m}_{Ely,O_2,out} =  v_{O_2,H_2} \enspace  \dot{m}_{Ely,H_2} </script>
<script type="math/tex; mode=display"> \text{with} \quad v_{O_2,H_2} = \frac{atomic \ mass \ O_2}{atomic \ mass \ 2 \ H_2} = \frac{2 * 15,9990 \ u}{2*2*1,0008 \ u} = 7,9386 </script>
</p>
<p>The required mass flow of water <script type="math/tex">\dot{m}_{Ely,H_2O,in}</script> can be determined from the supplied masses of hydrogen and oxygen and the purification losses in the water treatment unit, characterized by the fraction of purification losses <script type="math/tex">\eta_{H_2O \ treatment}</script>.
<script type="math/tex; mode=display"> \dot{m}_{Ely,H_2O,in} = \frac{\dot{m}_{Ely,H_2}  + \dot{m}_{Ely,O_2,out}}{1- \eta_{H_2O \ treatment}} </script>
</p>
<p><strong>Assumption:</strong> The electrolyzer is only operated between minimum 0 % and maximum 100 % load. A specification of power above nominal power, which frequently occurs in practice, is not supported. </p>
<p><strong>TODO:</strong> Efficiency decrease (el.) due to degradation?</p>
<p><strong>Inputs and Outputs of the Electrolyser:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">P_{el,Ely}</script>
</td>
<td>electrical power requirement of the electrolyser</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,Ely,supply}</script>
</td>
<td>electrical power requirement of the electrolyser incl. losses of power electronics</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{Ely,H_2O,in}</script>
</td>
<td>water mass flow fed to the electrolyser</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{Ely,O_2,out}</script>
</td>
<td>oxygen mass flow delivered by the electrolyser</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{Ely,H_2}</script>
</td>
<td>hydrogen mass flow produced by the electrolyser (before <script type="math/tex">H_2</script>-cleaning losses)</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{Ely,H_2,out}</script>
</td>
<td>hydrogen mass flow provided by the electrolyser (after <script type="math/tex">H_2</script>-cleaning losses)</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{E}_{Ely,H_2}</script>
</td>
<td>hydrogen energy flow discharged from the electrolyser (before <script type="math/tex">H_2</script>-cleaning losses)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{E}_{Ely,H_2,out}</script>
</td>
<td>hydrogen energy flow provided by the electrolyser <script type="math/tex">after (H_2</script>-cleaning losses)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{Ely,cooling,in}</script>
</td>
<td>cooling fluid inlet temperature of electrolyser</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{Ely,cooling,out}</script>
</td>
<td>cooling fluid outlet temperature of electrolyser</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{Ely,waste heat}</script>
</td>
<td>waste heat provided by the electrolyser</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{Ely,loss}</script>
</td>
<td>thermal losses in elektrolyser (unused waste heat))</td>
<td>[MW]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the Electrolyser:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">P_{el,Ely,rated}</script>
</td>
<td>electric power consumption of the electrolyser under full load (operating state 100 %)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{Ely,H_2}(x_{Ely},P_{el,Ely,rated})</script>
</td>
<td>efficiency of hydrogen production of the electrolyser (<script type="math/tex">\dot{E}_{Ely,H_2,out}</script> related to <script type="math/tex">P_{el,Ely}</script> as a function of operating state, plant size and plant type)</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{Ely,heat}</script>
</td>
<td>efficiency of the usable heat extraction of the electrolyzer (related to <script type="math/tex">1-\eta_{Ely,H_2}</script>)</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{Ely,LE}</script>
</td>
<td>efficiency of the power electronics of the electrolyser</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">PL_{Ely,min}</script>
</td>
<td>minimum allowed partial load of the electrolyzer</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">MOT_{Ely}</script>
</td>
<td>minimum operating time of the electrolyser</td>
<td>[min]</td>
</tr>
<tr>
<td>
<script type="math/tex">SUP_{Ely}</script>
</td>
<td>start-up time of the electrolyser until full heat supply (linear curve)</td>
<td>[min]</td>
</tr>
<tr>
<td>
<script type="math/tex">e_{H_2} </script>
</td>
<td>mass-dependent energy of hydrogen (net calorific value or gross calorific value)</td>
<td></td>
</tr>
<tr>
<td>
<script type="math/tex">v_{O_2,H_2} </script>
</td>
<td>stoichiometric mass-based ratio of oxygen and hydrogen supply during electrolysis</td>
<td>[kg <script type="math/tex">O_2</script> / kg <script type="math/tex">H_2</script>]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{H_2 \ purification} </script>
</td>
<td>percentage of purification losses in hydrogen purification</td>
<td>[%]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{H_2O \ treatment} </script>
</td>
<td>percentage of purification losses in water treatment</td>
<td>[%]</td>
</tr>
<tr>
<td>
<script type="math/tex">p_{H_2,Ely} </script>
</td>
<td>pressure of hydrogen supply</td>
<td>[bar]</td>
</tr>
<tr>
<td>
<script type="math/tex">p_{O_2,Ely} </script>
</td>
<td>pressure of oxygen supply</td>
<td>[bar]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{Ely,cooling,in,max}</script>
</td>
<td>max. allowed temperature of cooling medium input</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the Electrolyser:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">x_{Ely}</script>
</td>
<td>current  operating state (on, off, part load)</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="reduction-of-usable-heat-during-start-up">Reduction of usable heat during start-up</h2>
<p><img alt="Heat reduction during start-up" src="../fig/221028_Start-up-Reduction_general.svg" /></p>
<p>Linear warm-up during start-up:
<script type="math/tex; mode=display">
 \dot{Q}_{out,reduced} = 
\begin{cases}
\dot{Q}_{out} \ \frac{\text{actual operating time}}{\text{minimum operating time}} & \text{actual operating time} \ < \text{minimum operating time} \\
\dot{Q}_{out} & \text{actual operating time} \ \geq  \text{minimum operating time}
\end{cases} 
</script>
</p>
<h2 id="combined-heat-and-power-plant-chp">Combined heat and power plant (CHP)</h2>
<p><img alt="Energy flow of CHP" src="../fig/221021_CHP.svg" /></p>
<p>Definiton of power-to-heat ratio of CHP:
<script type="math/tex; mode=display"> r_{CHP,PTH} = \frac{\eta_{CHP,el}}{\eta_{CHP,thermal}} = \frac{P_{el,CHP,rated}}{\dot{Q}_{CHP,rated}}  </script>
</p>
<p>Energy balance on CHP:
<script type="math/tex; mode=display">  \dot{E}_{CHP,gas,in} = P_{el,CHP,out} + \dot{Q}_{CHP,out} + \dot{Q}_{CHP,loss} </script>
</p>
<p>Calculation of electric power output:
<script type="math/tex; mode=display">  P_{el,CHP,out} = \eta_{CHP,el} \ \dot{E}_{CHP,gas,in}   </script>
</p>
<p>Calculation of thermal power output:
<script type="math/tex; mode=display">  \dot{Q}_{CHP,out} = \eta_{CHP,thermal} \ \dot{E}_{CHP,gas,in}   </script>
</p>
<p>Calculation of thermal losses in CHP:
<script type="math/tex; mode=display"> \dot{Q}_{CHP,loss} = (1-\eta_{CHP,thermal}+\eta_{CHP,el}) \ \dot{E}_{CHP,gas,in} </script>
</p>
<p>Relation of electric and thermal power output:
<script type="math/tex; mode=display"> P_{el,CHP,out} = \frac{\eta_{CHP,el}}{\eta_{CHP,thermal}} \ \dot{Q}_{CHP,out} =  r_{CHP,PTH}  \ \dot{Q}_{CHP,out}  </script>
</p>
<p><strong>TODO:</strong> Part load efficiency reduction?</p>
<p><strong>Inputs and Outputs of the CHP:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">P_{el,CHP,out}</script>
</td>
<td>electric power output of the CHP</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,CHP}</script>
</td>
<td>electric power provided by the CHP</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{CHP,out}</script>
</td>
<td>thermal power output of the CHP</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{E}_{CHP,gas,in}</script>
</td>
<td>energy demand of the CHP, natural or green gas (NCV or GCV)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{CHP,loss}</script>
</td>
<td>thermal energy losses of the CHP</td>
<td>[MW]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the CHP:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">P_{el,CHP,rated}</script>
</td>
<td>rated electric power output of the CHP under full load (operating state 100 %)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{CHP,rated}</script>
</td>
<td>rated thermal power output of the CHP under full load (operating state 100 %)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{CHP,thermal}</script>
</td>
<td>thermal efficiency of CHP (regading NCV or GCV, needs to correspond to <script type="math/tex">\dot{E}_{CHP,gas,in}</script>)</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{CHP,el}</script>
</td>
<td>electrical efficiency of CHP, including selfe-use of electrical energy (regading NCV or GCV, needs to correspond to <script type="math/tex">\dot{E}_{CHP,gas,in}</script>)</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">r_{CHP,PTH}</script>
</td>
<td>power-to-heat ratio of CHP</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">PL_{CHP,min}</script>
</td>
<td>minimum allowed partial load of the CHP</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">MOT_{CHP}</script>
</td>
<td>minimum operating time of the CHP</td>
<td>[min]</td>
</tr>
<tr>
<td>
<script type="math/tex">SUP_{CHP}</script>
</td>
<td>start-up time of the CHP until full heat supply (linear curve)</td>
<td>[min]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the CHP:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">x_{CHP}</script>
</td>
<td>current operating state of the CHP (on, off, part load)</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="gas-boiler-gb">Gas boiler (GB)</h2>
<p><img alt="Energy flow of gas boiler" src="../fig/221021_Gaskessel.svg" /></p>
<p>Energy balance of gas boilder:
<script type="math/tex; mode=display">  \dot{Q}_{GB,out} = \dot{E}_{GB,gas,in} - \dot{Q}_{GB,loss} = \eta_{GB} \ \dot{E}_{GB,gas,in}   </script>
</p>
<p><strong>TODO:</strong> Part load efficiency reduction?</p>
<p><strong>Inputs and Outputs of the GB:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\dot{Q}_{GB,out}</script>
</td>
<td>thermal power output of the GB</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{E}_{GB,gas,in}</script>
</td>
<td>energy demand of the GB, natural or green gas (NCV or GCV)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{GB,loss}</script>
</td>
<td>thermal losses of the GB</td>
<td>[MW]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the GB:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">Q_{GB,rated}</script>
</td>
<td>rated thermal power output of the GB under full load (operating state 100 %)</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex"> \eta_{GB}</script>
</td>
<td>thermal efficiency of gas boiler (regading NCV or GCV, needs to correspond to <script type="math/tex">\dot{E}_{GB,gas,in}</script>)</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">PL_{GB,min}</script>
</td>
<td>minimum allowed partial load of the GB</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">MOT_{GB}</script>
</td>
<td>minimum operating time of the GB</td>
<td>[min]</td>
</tr>
<tr>
<td>
<script type="math/tex">SUP_{GB}</script>
</td>
<td>start-up time of the GB until full heat supply (linear curve)</td>
<td>[min]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the GB:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">x_{GB}</script>
</td>
<td>current operating state of the GB (on, off, part load)</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="oil-heating-oh">Oil heating (OH)</h2>
<p><img alt="Energy flow of oil heating" src="../fig/221028_Oelkessel.svg" /></p>
<h2 id="elecric-heating-rod-er">Elecric heating rod (ER)</h2>
<p><img alt="Energy flow of electric rod" src="../fig/221028_ElectricRod.svg" /></p>
<h2 id="biomass-boiler-bb">Biomass boiler (BB)</h2>
<p><img alt="Energy flow of biomass boiler" src="../fig/221028_BiomassBoiler.svg" /></p>
<h2 id="heat-sources">Heat sources</h2>
<h3 id="soil">Soil</h3>
<ul>
<li>geothermal probes</li>
<li>geothermal collector </li>
<li>...</li>
</ul>
<p>Regernation von Wärmequellen --&gt; Erdwärmesonden sind eher Speicher als Wärmequellen</p>
<h3 id="water">Water</h3>
<ul>
<li>groundwater well</li>
<li>surface waters</li>
<li>waste heat from industrial processes</li>
<li>wastewater</li>
<li>solar thermal collector</li>
</ul>
<h3 id="air">Air</h3>
<ul>
<li>ambient air</li>
<li>exhaust air</li>
<li>hot air absorber</li>
</ul>
<h3 id="external-source">External source</h3>
<ul>
<li>district heating network</li>
</ul>
<p>(Vergleich FutureHeatPump II Projekt)</p>
<h2 id="chiller-ch">Chiller (CH)</h2>
<h3 id="simple-model-for-electrolyser">Simple model for electrolyser</h3>
<h3 id="general-model-for-cooling-purposes">General model for cooling purposes</h3>
<p>or just one general model?</p>
<h2 id="short-term-thermal-energy-storage-sttes">Short-term thermal energy storage (STTES)</h2>
<p><img alt="Energy flow of STTES" src="../fig/221028_STTES.svg" /></p>
<p><img alt="Scetch of STTES" src="../fig/221021_STTES_scetch.svg" /></p>
<p>The short-term energy storage is a simplified model without thermal losses to the ambient. It consists of two adiabatically separated temperature layers, represented as an ideally layered storage without any interaction between the two layers. This model was chosen to keep the computational effort as small as possible. If a more complex model is needed, the seasonal thermal energy storage can be used that is including energy and exergetic losses.</p>
<p>The rated thermal energy content <script type="math/tex">Q_{STTES,rated}</script> of the STTES can be calculated using the volume <script type="math/tex">V_{STTES}</script>, the density <script type="math/tex">\rho_{STTES}</script>, the specific thermal capacity of the medium in the storage <script type="math/tex">cp_{STTES}</script> and the temperature span within the STTES:
<script type="math/tex; mode=display"> Q_{STTES,rated} = V_{STTES} \ \rho_{STTES} \ cp_{STTES} \ (T_{STTES,hot} - T_{STTES,cold}) </script>
</p>
<p>The amount of the total input (<script type="math/tex">Q_{STTES,in,t}</script>) and output energy (<script type="math/tex">Q_{STTES,out,t}</script>) in every timestep is defined as
<script type="math/tex; mode=display">  Q_{STTES,in,t} = \dot{Q}_{STTES,in,t} \ \Delta t = \dot{m}_{STTES,in} \ cp_{STTES} \ (T_{STTES,hot} - T_{STTES,cold}) \ \Delta t </script>
and
<script type="math/tex; mode=display">  Q_{STTES,out,t} = \dot{Q}_{STTES,out,t} \ \Delta t = \dot{m}_{STTES,out} \ cp_{STTES} \ (T_{STTES,hot} - T_{STTES,cold}) \ \Delta t. </script>
</p>
<p>The current charging state <script type="math/tex">x_{STTES,t+1}</script> can be calculated using the following equation and the charging state of the previous timestep (<script type="math/tex">x_{STTES,t}</script>) as well as the input and output energy
<script type="math/tex; mode=display"> x_{STTES,t+1} = x_{STTES,t} + \frac{Q_{STTES,in,t} - Q_{STTES,out,t}}{Q_{STTES,rated}}   </script>
</p>
<p>leading to the total energy content in every timestep as
<script type="math/tex; mode=display"> Q_{STTES,t} = Q_{STTES,rated} \ x_{STTES,t}. </script>
</p>
<p>The limits of the thermal power in- and output (<script type="math/tex">\dot{Q}_{STTES,in}</script> and <script type="math/tex">\dot{Q}_{STTES,out}</script>) due to the current energy content and maximum c-rate of the STTES are given as
<script type="math/tex; mode=display"> \frac{Q_{STTES,rated} - {Q}_{STTES}}{\Delta \ t}  \stackrel{!}{\geq}   \dot{Q}_{STTES,in} \stackrel{!}{\leq}  c_{STTES,max,load} \ Q_{STTES,rated}  </script>
<script type="math/tex; mode=display"> \frac{{Q}_{STTES}}{\Delta \ t}  \stackrel{!}{\geq}   \dot{Q}_{STTES,out} \stackrel{!}{\leq}  c_{STTES,max,unload} \ Q_{STTES,rated}  </script>
</p>
<p><strong>Inputs and Outputs of the STTES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\dot{Q}_{STTES,in}</script>
</td>
<td>thermal power input in the STTES</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{STTES,out}</script>
</td>
<td>thermal power output of the STTES</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{STTES,in}</script>
</td>
<td>current mass flow rate into the STTES</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{STTES,out}</script>
</td>
<td>current mass flow rate out of the STTES</td>
<td>[kg/h]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the STTES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">c_{STTES,max,load}</script>
</td>
<td>maximum charging rate (C-rate) of STTES</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">c_{STTES,max,unload}</script>
</td>
<td>maximum discharging rate (C-rate) of STTES</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">Q_{STTES,rated}</script>
</td>
<td>rated thermal energy capacity of the STTES</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">x_{STTES,start}</script>
</td>
<td>thermal energy contend of the STTES at the beginning of the simulation in relation to <script type="math/tex">Q_{STTES,rated}</script>
</td>
<td>[%]</td>
</tr>
<tr>
<td>
<script type="math/tex">V_{STTES}</script>
</td>
<td>volume of the STTES</td>
<td>[m<script type="math/tex">^3</script>]</td>
</tr>
<tr>
<td>
<script type="math/tex">\rho_{STTES}</script>
</td>
<td>densitiy of the heat carrier medium in the STTES</td>
<td>[kg/m<script type="math/tex">^3</script>]</td>
</tr>
<tr>
<td>
<script type="math/tex">cp_{STTES}</script>
</td>
<td>specifiy heat capacity of the heat carrier medium in the STTES</td>
<td>[kJ/(kg K)]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STTES,hot}</script>
</td>
<td>rated upper temperature of the STTES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STTES,cold}</script>
</td>
<td>rated lower temperature of the STTES</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the STTES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">{Q}_{STTES}</script>
</td>
<td>current amount of thermal energy stored in the STTES</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">x_{STTES}</script>
</td>
<td>current charging state of the STTES</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="seasonal-thermal-energy-storage-stes">Seasonal thermal energy storage (STES)</h2>
<p>Seasonal thermal energy storages can be used to shift thermal energy from the summer to the heating period in the winter. Due to the long storage period, energy losses to the environment and exergy losses within the storage must be taken into account.</p>
<h3 id="tank-ttes-and-pit-ptes-thermal-energy-storage">Tank (TTES) and Pit (PTES) thermal energy storage</h3>
<p>Neglected: Thermal capacity of the surrounding soil, gravel-water storages</p>
<h4 id="generalized-geometry-for-ttes-and-ptes">Generalized geometry for TTES and PTES</h4>
<p><img alt="Geometry of STES" src="../fig/221028_STES_Geometry.png" />
Figure and method of generalized geometry definition based on [Steinacker2022]<sup id="fnref2:Steinacker2022"><a class="footnote-ref" href="#fn:Steinacker2022">15</a></sup>.</p>
<p>Ratio between height and mean radius of the STES:
<script type="math/tex; mode=display"> hr_{STES} = \frac{h_{STES}}{\bar{r}_{STES}}  = \frac{h_{STES}}{\frac{R_{STES}+r_{STES}}{2}} </script>
</p>
<p>Upper radius of the STES in dependence of the Volume and <script type="math/tex">hr_{STES}</script>:
<script type="math/tex; mode=display">
R_{STES} = \sqrt[3]{ \frac{3 \ V_{STES}}{\pi \ \tan(\alpha_{STES})  \ \left( 1 - \beta^3 \right) } }   \quad \mathrm{with} \quad  \beta = \frac{2 \ \tan(\alpha_{STES}) - hr_{STES}}{2 \ \tan(\alpha_{STES})+hr_{STES}}
</script>
Lower radius of the STES in dependence of the upper radius <script type="math/tex">R_{STES}</script>:
<script type="math/tex; mode=display"> r_{STES} = R_{STES}  \ \beta </script>
</p>
<p>Slope angle has to be in the range of
<script type="math/tex; mode=display">    180° - \arctan{\left(\frac{hr_{STES}}{2} \right)} \geq \alpha_{STES} \geq \arctan{\left(\frac{hr_{STES}}{2} \right)} </script>
to ensure the shape of a zylinder, a cone or a truncated cone. Analogously, the ratio beween the height and the mean radius of the STES <script type="math/tex">hr_{LZWSP}</script> has to be smaller as
<script type="math/tex; mode=display">  hr_{LZWSP} \leq 2 \ \tan(\alpha_{LZWSP}) \mathrm{\quad with \quad}   0 ° < \alpha_{LZWSP} < 90 ° </script>
</p>
<p>The heigt of the STES can be calculated as
<script type="math/tex; mode=display"> h_{STES} = hr_{STES} \ \frac{R_{STES}+r_{STES}}{2}   </script>
resulting with the number of layers <script type="math/tex">n_l</script> into the thickness of each layer
<script type="math/tex; mode=display"> \Delta z_{l} = \frac{h_{STES}}{n_l} = \text{constant for all layers} </script>
</p>
<p>Lateral surface of each layer with heigt <script type="math/tex">h_l</script>, upper radius <script type="math/tex">R_l</script> and lower radius <script type="math/tex">r_l</script> of each layer:
<script type="math/tex; mode=display"> M_{STES,l} = (R_l + r_l) \ \pi \ \sqrt{(R_l - r_l)^2 + h_l^2}  </script>
</p>
<p>Volume of each layer:
<script type="math/tex; mode=display"> V_{STES,l} = \frac{h_l}{3} \pi \ (R_l^2 + R_l \ r_l \ + r_l^2)  </script>
</p>
<h4 id="thermal-model-for-stratisfied-storage">Thermal model for stratisfied storage</h4>
<p><img alt="Energy flow of STES" src="../fig/221028_STES.svg" /></p>
<p>General energy balance in every timestep <script type="math/tex">t</script>:
<script type="math/tex; mode=display">  
Q_{STES,t} = Q_{STES,t-1} + (\dot{Q}_{STES,load} - \dot{Q}_{STES,unload} - \dot{Q}_{STES,loss,amb}) \ \Delta t
</script>
</p>
<p><img alt="Layer model of STES" src="../fig/221021_STES_layers.png" />
Figure adapted from [Steinacker2022]<sup id="fnref3:Steinacker2022"><a class="footnote-ref" href="#fn:Steinacker2022">15</a></sup>.</p>
<p>Stratisfied storage model based on [Lago2019]<sup id="fnref:Lago2019"><a class="footnote-ref" href="#fn:Lago2019">14</a></sup> and modified to account for cones according to [Steinacker2022]<sup id="fnref4:Steinacker2022"><a class="footnote-ref" href="#fn:Steinacker2022">15</a></sup> and for half-burried storages.</p>
<p>Three different energy or exergy loss mechanisms are taken into account as shown in the figure above:</p>
<ul>
<li>Energy losses to the environment through the outer walls (bottom, walls and lid) of each storage layer (<script type="math/tex">\dot{Q}_{STES,loss}</script>), characterized by the heat transfer coefficient of the outer surfaces <script type="math/tex">U_{STES,bottom/wall/lid}</script>
</li>
<li>Exergy losses due to diffusion processes between the storage layers <script type="math/tex">\dot{Q}_{STES,diffus.}</script>, specified by the diffusion coefficient <script type="math/tex">\xi_{STES}</script>
</li>
<li>Exergy losses due to convection (buoyancy) between the storage layers <script type="math/tex">\dot{Q}_{STES,buoy.}</script>.</li>
</ul>
<p>The temperature <script type="math/tex">T_l</script> in layer <script type="math/tex">l</script> with height <script type="math/tex">\Delta z_l</script> is given by the partial differential equation 
<script type="math/tex; mode=display">
\frac{\delta T_{STES,l} }{\delta t} = \underbrace{\xi_{STES} \frac{\delta^2 T_{STES,l}}{\delta z^2}}_{\text{diffusion}} + \underbrace{\frac{M_{STES,l} \ U_{STES,l}}{\rho_{STES} \ c_{p,STES} \ V_{STES,l}} \left(T_{STES,amb,l} - T_{STES,l}\right)}_{\text{energy losses to ambient}}  + \  \cdot  \cdot  \cdot \\ 
\ \\
\ \underbrace{\frac{\dot m_{STES} (T_{STES,l,in}-T_{STES,l})}{\rho_{STES} \ V_{STES,l}}}_{\text{direct (un-)loading}}
</script>
</p>
<p>The ambient temperature of each layer <script type="math/tex">T_{amb,l}</script> can be either the ambient air temperature <script type="math/tex">T_{amb,air}</script> in the specific time step or the ground temperature <script type="math/tex">T_{ground}</script> depending on the considered layer <script type="math/tex">l</script> and the number of layer burried under the ground surface.</p>
<p>Using the explicite Euler method for integration, the previous equation leads to the temperature in every timestep <script type="math/tex">t</script> and layer <script type="math/tex">l</script> with respect to the temperatures in the timestep bevore and the layers around (without the index <script type="math/tex">_{STES}</script> for better overview)
<script type="math/tex; mode=display">
\begin{aligned} 
    &T_{t+1,l}  = T_{t,l} + \left( \xi_{STES} \frac{T_{t,l+1} + T_{t,l-1} - 2 T_{t,l}}{\Delta z^2_{l,vol}} +  \sigma_l (T_{amb,l} - T_{t,l})    + \phi_l \dot{m}_{t,l} \left(T_{t,l,in} - T_{t,l}   \right)  \right) \Delta t \\
%    
    & \text{with the volume-related layer height} \\
    &\Delta z_{l,vol} = \Delta z_l \ \sqrt{\frac{n_l \ V_{STES,l}}{V_{STES}} }  \ \ \text{(because \(\Delta z_l = const.\), but \(V_{STES,l} \neq const.\)),}  \\[5pt]
%    
    & \text{the coefficient of heat losses to the environment} \\
    &\sigma_l = \begin{cases}
        \frac{A_{STES,lid} \ U_{STES,lid} + M_{STES,l} \ U_{STES,l}}{c_{p,STES} \ \rho_{STES} \ V_{LZSWP,l}} &\text{for l = lid layer} \\[5pt]
        \frac{A_{STES,bottom} \ U_{STES,bottom} + M_{STES,l} \ U_{STES,l}}{c_{p,STES} \ \rho_{STES} \ V_{LZSWP,l}} &\text{for l = bottom layer} \\[5pt]
        \frac{M_{STES,l} \ U_{STES,l}}{c_{p,STES} \ \rho_{STES} \ V_{LZSWP,l}} &\text{for l = sandwich layers}      
    \end{cases} \\
%    
    &\text{and the coefficient for direct loading and unloading} \\ 
    &\phi_l =  \frac{1 }{\rho_{STES} \ V_{STES,l}} \ 
%   
\end{aligned}
</script>
</p>
<p>As the coefficients mentioned above are constant within the simulation time, they can be precomputed for cumputational efficiency.</p>
<p>To illustrate the principle of the implemented model, the following figure shows the mass flow into and out of the STES as well as examplary for one transition between two layers the mass flow between the layers within the model. The corresponding temperatures are the temperatures of the source (input flow or layer temperature of the previous layer). As a convention, the lowermost layer is labeled with the number 1. The inflow and outflow is always in the top and bottom layers. For correct results, the inegrated mass flow within one timestep has to be smaller than the volume of the smallest layer element of the storage (ToDo: Maybe fix this issue in Quasi II?)</p>
<p><img alt="Layer Model of STES" src="../fig/221103_STES_layer_temp.svg" /></p>
<p>To account for buoyancy effects, a check is made in each time step to determine whether the temperature gradient in the reservoir corresponds to the physically logical state, meaning that the temperatures in the upper layers are higher than in the lower storage layers. If, however, an inverse temperature gradient is present, a mixing process is performed in each time step for all layers, beginning with <script type="math/tex">l=2</script>:
<script type="math/tex; mode=display">
T_l = T_l + \theta_l \ \text{max} (0, T_{l-1} - T_l) \text{ for } l > 1 \text{ and }\\
T_{l-1} = T_{l-1} - (1-\theta_l) \ \text{max} (0, T_{l-1} - T_l) \text{ for } l > 1
</script>
using the volume-ratio of each layer <script type="math/tex">\theta_l</script> with respect to the surrounding layers, inspired by [Lago2019]<sup id="fnref2:Lago2019"><a class="footnote-ref" href="#fn:Lago2019">14</a></sup>:
<script type="math/tex; mode=display">  \theta_{l}  = \frac{V_{STES,l-1}}{V_{STES,l} + V_{STES,l-1}} \in [0,1] \text{ for } l > 1. </script>
</p>
<p>This method was extensively tested in [Steinacker2022]<sup id="fnref5:Steinacker2022"><a class="footnote-ref" href="#fn:Steinacker2022">15</a></sup> and compared to calculations performed with TRNSYS Type 142 with high agreement. Is was shown that an optimal number of layers for this model is 25, considering computational efficiency and quality of the results. </p>
<p><strong>Inputs and Outputs of the STES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\dot{Q}_{STES,load}</script>
</td>
<td>thermal power input in the STES</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{Q}_{STES,unload}</script>
</td>
<td>thermal power output of the STES</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{STES,load}</script>
</td>
<td>current mass flow rate into the STES</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">\dot{m}_{STES,unload}</script>
</td>
<td>current mass flow rate out of the STES</td>
<td>[kg/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,load,hot}</script>
</td>
<td>temperature of input mass flow while loading the STES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,load,cold}</script>
</td>
<td>temperature of output mass flow while loading the STES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,unload,hot}</script>
</td>
<td>temperature of input mass flow while unloading the STES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,unload,cold}</script>
</td>
<td>temperature of output mass flow while unloading the STES</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the STES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">Q_{STES,rated}</script>
</td>
<td>rated thermal energy capacity of the STES</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">x_{STES,start}</script>
</td>
<td>thermal energy contend of the STES at the beginning of the simulation in relation to <script type="math/tex">Q_{STES,rated}</script>
</td>
<td>[%]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,hot}</script>
</td>
<td>rated upper temperature of the STES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">T_{STES,cold}</script>
</td>
<td>rated lower temperature of the STES</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">c_{STES,max,load}</script>
</td>
<td>maximum charging rate (C-rate) of STES</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">c_{STES,max,unload}</script>
</td>
<td>maximum discharging rate (C-rate) of STES</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">V_{STES}</script>
</td>
<td>volume of the STES</td>
<td>[m<script type="math/tex">^3</script>]</td>
</tr>
<tr>
<td>
<script type="math/tex">\alpha_{STES,slope}</script>
</td>
<td>slope angle of the wall of the STES with respect to the horizon</td>
<td>[°]</td>
</tr>
<tr>
<td>
<script type="math/tex">hr_{STES}</script>
</td>
<td>ratio between height and mean radius of the STES</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\rho_{STES}</script>
</td>
<td>densitiy of the heat carrier medium in the STES</td>
<td>[kg/m<script type="math/tex">^3</script>]</td>
</tr>
<tr>
<td>
<script type="math/tex">cp_{STES}</script>
</td>
<td>specific heat capacity of the heat carrier medium in the STES</td>
<td>[kJ/(kg K)]</td>
</tr>
<tr>
<td>
<script type="math/tex">\xi_{STES}</script>
</td>
<td>coefficient of diffusion of the heat carrier medium in the STES into itself</td>
<td>[m<script type="math/tex">^2</script>/s]</td>
</tr>
<tr>
<td>
<script type="math/tex">U_{STES,lid}</script>
</td>
<td>heat transfer coefficient of the STES' lid</td>
<td>[W/m<script type="math/tex">^2</script> K]</td>
</tr>
<tr>
<td>
<script type="math/tex">U_{STES,wall}</script>
</td>
<td>heat transfer coefficient of the STES' wall</td>
<td>[W/m<script type="math/tex">^2</script> K]</td>
</tr>
<tr>
<td>
<script type="math/tex">U_{STES,bottom}</script>
</td>
<td>heat transfer coefficient of the STES' bottom</td>
<td>[W/m<script type="math/tex">^2</script> K]</td>
</tr>
<tr>
<td>
<script type="math/tex">n_{STES,layers,total}</script>
</td>
<td>number of thermal layer in the STES for the simulation</td>
<td>[pcs.]</td>
</tr>
<tr>
<td>
<script type="math/tex">n_{STES,layers,above \ ground}</script>
</td>
<td>number of thermal layer of the STES above the ground surface</td>
<td>[pcs.]</td>
</tr>
<tr>
<td>
<script type="math/tex">\boldsymbol{T}_{STES,ground}</script>
</td>
<td>timeseries or constant of ground temperature</td>
<td>[°C]</td>
</tr>
<tr>
<td>
<script type="math/tex">\boldsymbol{T}_{STES,amb}</script>
</td>
<td>timeseries of ambient temperature</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the STES:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">{Q}_{STES}</script>
</td>
<td>current amount of thermal energy stored in the STES</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">x_{STES}</script>
</td>
<td>current charging state of the STES</td>
<td>[%]</td>
</tr>
<tr>
<td>
<script type="math/tex">\boldsymbol{T}_{STES}</script>
</td>
<td>vector of current temperatures in every layer of the STES</td>
<td>[°C]</td>
</tr>
</tbody>
</table>
<h3 id="borehole-thermal-energy-storage-btes">Borehole thermal energy storage (BTES)</h3>
<p>Borehole thermal energy storages are not implemented yet.</p>
<h3 id="aquifer-thermal-energy-storage-ates">Aquifer thermal energy storage (ATES)</h3>
<p>Aquifer thermal energy storages are not implemented yet.</p>
<h2 id="ice-storage-is">Ice storage (IS)</h2>
<h2 id="hydrogen-fuel-cell-fc">Hydrogen fuel cell (FC)</h2>
<p><img alt="Energy flow of hydrogen fuel cell" src="../fig/221031_H2_Fuel_Cell.svg" /></p>
<h2 id="photovoltaik-pv">Photovoltaik (PV)</h2>
<p><img alt="Energy flow of photovoltaik" src="../fig/221028_PV.svg" /></p>
<p>For the calculation of the electrical power output of photovoltaic systems, a separate simulation tool was developed and integrated into QuaSi. It is based on the Python extension pvlib<sup id="fnref:pvlib"><a class="footnote-ref" href="#fn:pvlib">17</a></sup> and uses the model chain approach described in the pvlib documentation. Technical data of specific PV modules and DC-AC interverts are taken from the SAM model<sup id="fnref:SAM-Model"><a class="footnote-ref" href="#fn:SAM-Model">16</a></sup> and integrated into pvlib.</p>
<p>Inputs can include orientation, tilt, ambient albedo, type of installation (e.g. roof-added, free-standing), as well as module interconnection and specific PV modules and inverters chosen from the library. Additional losses, such as ohmic losses in cables or losses due to soiling, can be taken into account. A weather input dataset is required that includes direct normal, global horizontal and diffuse horizontal irradiance as well as ambient (dry bulb) temperature, humidity and wind speed.   </p>
<h2 id="wind-power-wp">Wind power (WP)</h2>
<p><img alt="Energy flow of wind power" src="../fig/221028_Wind.svg" /></p>
<p>windpowerlib </p>
<p>Achtung: Winddaten von EPW nicht geeignet!</p>
<h2 id="battery-ba">Battery (BA)</h2>
<p><img alt="Energy flow of battery" src="../fig/221025_battery.svg" /></p>
<p>Energy balance of battery in every timestep:
<script type="math/tex; mode=display">  E_{GB,t+1} = E_{GB,t} + \Delta t \ ( \eta_{BA,charge} \ P_{el,BA,in} - \ \frac{P_{el,BA,out}}{\eta_{BA,discharge}} - P_{el,BA,loss,self}) </script>
</p>
<p>Self-Discharge losses of battery:
<script type="math/tex; mode=display"> P_{el,BA,loss,self} = r_{BA,self \ discharge} \ \frac{1 \ h}{\Delta t} \ E_{GB,t} </script>
</p>
<p>Charging losses of battery:
<script type="math/tex; mode=display"> P_{el,BA,loss,charge} = (1 - \eta_{BA,charge}) \ P_{el,BA,in} </script>
</p>
<p>Discharging losses of battery:
<script type="math/tex; mode=display"> P_{el,BA,loss,discharge} = \frac{1 - \eta_{BA,discharge}}{\eta_{BA,discharge}} \ P_{el,BA,out} </script>
</p>
<p>Current maximum capacity of the battery:
<script type="math/tex; mode=display"> E_{GB,max,current} = E_{GB,rated} \ (1-r_{GB,CapReduction}) ^{ n_{cycles \ performed}} </script>
<script type="math/tex; mode=display"> \text{with} \ n_{cycles \ performed} = \frac{\int_{start}^{current} P_{el,BA,in} dt}{E_{GB,rated}} </script>
</p>
<p>Limits of electrical power in- and output (limit to current energy content and maximum c-rate of battery):
<script type="math/tex; mode=display"> \frac{E_{GB,max,current} - E_{GB}}{\Delta t \ \ \eta_{BA,charge} } \stackrel{!}{\geq}  P_{el,BA,in} \stackrel{!}{\leq}  c_{BA,max,charge} \ E_{GB,max,current}  </script>
<script type="math/tex; mode=display"> \eta_{BA,discharge} \ \frac{E_{GB}}{\Delta t} \stackrel{!}{\geq}  P_{el,BA,out} \stackrel{!}{\leq}  c_{BA,max,discharge} \ E_{GB,max,current} </script>
</p>
<p>Relation beween current charging state in percent and in energy content:
<script type="math/tex; mode=display"> E_{GB} = E_{GB,max,current} \ x_{GB} </script>
</p>
<p><strong>Inputs and Outputs of the BA:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">P_{el,BA,in}</script>
</td>
<td>electrical power input in the BA</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,BA,out}</script>
</td>
<td>electrical power output of the BA</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,BA,loss,self}</script>
</td>
<td>electrical power losses of the BA due to self-discharging</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,BA,loss,charge}</script>
</td>
<td>electrical power losses of the BA while charging</td>
<td>[MW]</td>
</tr>
<tr>
<td>
<script type="math/tex">P_{el,BA,loss,discharge}</script>
</td>
<td>electrical power losses of the BA while discharging</td>
<td>[MW]</td>
</tr>
</tbody>
</table>
<p><strong>Parameter of the BA:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\eta_{BA,charge}</script>
</td>
<td>charging efficiency of battery</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">\eta_{BA,discharge}</script>
</td>
<td>discharging efficiency of battery</td>
<td>[-]</td>
</tr>
<tr>
<td>
<script type="math/tex">r_{BA,self \ discharge}</script>
</td>
<td>self-discharge rate of battery (% losses per hour regarding current energy content)</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">c_{BA,max,charge}</script>
</td>
<td>maximum charging rate (C-rate) of battery</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">c_{BA,max,discharge}</script>
</td>
<td>maximum discharging rate (C-rate) of battery</td>
<td>[1/h]</td>
</tr>
<tr>
<td>
<script type="math/tex">{E}_{GB,rated}</script>
</td>
<td>rated electrical energy capacity of the battery</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">r_{GB,CapReduction}</script>
</td>
<td>percentage of the reduction of the current battery capacity due to one full charge cycle</td>
<td>[%/cycle]</td>
</tr>
<tr>
<td>
<script type="math/tex">{E}_{GB,start}</script>
</td>
<td>electrical energy contend of the battery at the beginning of the simulation</td>
<td>[MWh]</td>
</tr>
</tbody>
</table>
<p><strong>State variables of the BA:</strong></p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Description</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">{E}_{GB}</script>
</td>
<td>current amount of energy stored in the battery</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">{E}_{GB,max,current}</script>
</td>
<td>current maximum capacity of the battery depending on the number of charging cycles already performed</td>
<td>[MWh]</td>
</tr>
<tr>
<td>
<script type="math/tex">x_{GB}</script>
</td>
<td>current charging state of the battery</td>
<td>[%]</td>
</tr>
</tbody>
</table>
<h2 id="hydrogen-compressor-hc">Hydrogen compressor (HC)</h2>
<p><img alt="Energy flow of hydrogen compressor" src="../fig/221028_HydroCompress.svg" /></p>
<h2 id="todo">ToDo</h2>
<ul>
<li>In Tabelle Parameter nur Parameter, die auch eingegeben werden, alle anderen im Text einführen</li>
<li>Definition einführen: <ul>
<li>Skalare: kursiv (normal math: <script type="math/tex">T \ t</script>)</li>
<li>Vektor/Zeitreihe: Fett und kursiv (boldsymbol: <script type="math/tex">\boldsymbol{T \ t}</script>)</li>
<li>Matrix: Fett und nichtkursiv (textbf: <script type="math/tex">\textbf{T t}</script>)</li>
</ul>
</li>
</ul>
<h2 id="references">References</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:Blervaque2015">
<p>Blervaque, H et al. (2015): Variable-speed air-to-air heat pump modelling approaches for building energy simulation and comparison with experimental data. <em>Journal of Building Performance Simulation 9 (2)</em>, S. 210–225. doi: <a href="https://doi.org/10.1080/19401493.2015.1030862">10.1080/19401493.2015.1030862</a>.&#160;<a class="footnote-backref" href="#fnref:Blervaque2015" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Blervaque2015" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:Arpagaus2018">
<p>Arpagaus C. et al. (2018): High temperature heat pumps: Market overview, state of the art, research status, refrigerants, and application potentials, <em>Energy</em>, doi: <a href="https://doi.org/10.1016/j.energy.2018.03.166">10.1016/j.energy.2018.03.166</a>&#160;<a class="footnote-backref" href="#fnref:Arpagaus2018" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:DINEN14511">
<p>DIN EN 14511:2018 (2018): Air conditioner, liquid chiling packages and heat pumps for space heating and cooling and process chillers, with electrically driven compressors. DIN e.V., Beuth-Verlag, Berlin.&#160;<a class="footnote-backref" href="#fnref:DINEN14511" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:Bettanini2003">
<p>Bettanini, E.; Gastaldello, A.; Schibuola, L. (2003): Simplified Models to Simulate Part Load Performance of Air Conditioning Equipments. <em>Eighth International IBPSA Conference, Eindhoven</em>, Netherlands, S. 107–114.&#160;<a class="footnote-backref" href="#fnref:Bettanini2003" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Bettanini2003" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:Toffanin2019">
<p>Toffanin, R. et al. (2019): Development and Implementation of a Reversible Variable Speed Heat Pump Model for Model Predictive Control Strategies. <em>Proceedings of the 16th IBPSA Conference</em>, S. 1866–1873.&#160;<a class="footnote-backref" href="#fnref:Toffanin2019" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Toffanin2019" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:Torregrosa-Jaime2008">
<p>Torregrosa-Jaime, B. et al. (2019): Modelling of a Variable Refrigerant Flow System in EnergyPlus for Building Energy Simulation in an Open Building Information Modelling Environment. <em>Energies 12 (1)</em>, S. 22. doi: <a href="https://doi.org/10.3390/en12010022">10.3390/en12010022</a>.&#160;<a class="footnote-backref" href="#fnref:Torregrosa-Jaime2008" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:Fuentes2019">
<p>Fuentes, E. et al. (2016): Improved characterization of water-to-water heat pumps part load performance. <em>REHVA Journal</em>, August 2016.&#160;<a class="footnote-backref" href="#fnref:Fuentes2019" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:Fahlen2012">
<p>Fahlén, Per (2012): Capacity control of heat pumps. <em>REHVA Journal Oktober 2012</em>, S. 28–31.&#160;<a class="footnote-backref" href="#fnref:Fahlen2012" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:Stiebel-EltronTool">
<p>Stiebel-Eltron Heat Pump Toolbox: <a href="https://www.stiebel-eltron.com/toolbox/waermepumpe/">https://www.stiebel-eltron.com/toolbox/waermepumpe/</a>&#160;<a class="footnote-backref" href="#fnref:Stiebel-EltronTool" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://enrgi.de/wp-content/uploads/2022/08/Datenblatt_ecoGEO_B-C_1-9kW.pdf">https://enrgi.de/wp-content/uploads/2022/08/Datenblatt_ecoGEO_B-C_1-9kW.pdf</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn:Socal2021">
<p>Socal, Laurent (2021): Heat pumps: lost in standards, <em>REHVA Journal August 2021</em>.&#160;<a class="footnote-backref" href="#fnref:Socal2021" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
<li id="fn:Wetter1996">
<p>Wetter M., Afjei T.: TRNSYS Type 401 - Kompressionswärmepumpe inklusive Frost- und Taktverluste. Modellbeschreibung und Implementation in TRNSYS (1996). Zentralschweizerisches Technikum Luzern, Ingenieurschule HTL. URL: <a href="https://trnsys.de/static/05dea6f31c3fc32b8db8db01927509ce/ts_type_401_de.pdf">https://trnsys.de/static/05dea6f31c3fc32b8db8db01927509ce/ts_type_401_de.pdf</a>&#160;<a class="footnote-backref" href="#fnref:Wetter1996" title="Jump back to footnote 12 in the text">&#8617;</a></p>
</li>
<li id="fn:Alfjei1996">
<p>Afjei T., Wetter M., Glass A. (1997): TRNSYS Type 204 - Dual-stage compressor heat pump including frost and cycl losses. Model description and implementation in TRNSYS, Versin 2. Zentralschweizerisches Technikum Luzern, Ingenieurschule HTL. URL: <a href="https://simulationresearch.lbl.gov/wetter/download/type204_hp.pdf">https://simulationresearch.lbl.gov/wetter/download/type204_hp.pdf</a>&#160;<a class="footnote-backref" href="#fnref:Alfjei1996" title="Jump back to footnote 13 in the text">&#8617;</a></p>
</li>
<li id="fn:Lago2019">
<p>Lago, J. et al. (2019): A 1-dimensional continuous and smooth model for thermally stratified storage tanks including mixing and buoyancy, <em>Applied Energy</em> 248, S. 640–
655: doi: <a href="https://doi.org/10.1016/j.apenergy.2019.04.139">10.1016/j.apenergy.2019.04.139</a>.&#160;<a class="footnote-backref" href="#fnref:Lago2019" title="Jump back to footnote 14 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Lago2019" title="Jump back to footnote 14 in the text">&#8617;</a></p>
</li>
<li id="fn:Steinacker2022">
<p>Steinacker, H (2022): Entwicklung eines dynamischen Simulationsmodells zur Optimierung von wärmegekoppelten Wasserstoffkonzepten für die klimaneutrale Quartiersversorgung, unpublished master thesis, University of Stuttgart.&#160;<a class="footnote-backref" href="#fnref:Steinacker2022" title="Jump back to footnote 15 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Steinacker2022" title="Jump back to footnote 15 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:Steinacker2022" title="Jump back to footnote 15 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:Steinacker2022" title="Jump back to footnote 15 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:Steinacker2022" title="Jump back to footnote 15 in the text">&#8617;</a></p>
</li>
<li id="fn:SAM-Model">
<p>System Advisor Model Version 2020.11.29 (SAM 2020.11.29). National Renewable Energy Laboratory. Golden, CO. URL: <a href="https://sam.nrel.gov">https://sam.nrel.gov</a>&#160;<a class="footnote-backref" href="#fnref:SAM-Model" title="Jump back to footnote 16 in the text">&#8617;</a></p>
</li>
<li id="fn:pvlib">
<p>Holmgren W. F., Hansen C. W. and Mikofski M. A. (2018): Pvlib Python: A python package for modeling solar energy systems, <em>Journal of Open Source Software 3(29), 884</em>, doi: <a href="https://doi.org/10.21105/joss.00884">https://doi.org/10.21105/joss.00884</a>&#160;<a class="footnote-backref" href="#fnref:pvlib" title="Jump back to footnote 17 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Quasi II Dokumentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Test/" class="btn btn-neutral float-right" title="Test">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Test/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
